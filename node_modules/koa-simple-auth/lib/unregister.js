"use strict";
let User = require('../');
module.exports = function *unregister(next){
  if(this.state.user){
    yield User.model.findOne({ email: this.state.user.email }).remove().exec();
    delete this.session.uid;
    delete this.state.user;
  } else {
    throw new Error("You are not logged in, you must be logged in to unregister");
  }
  yield next;
};
